<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPS Felfedező App</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c 0%, #b21f1f 50%, #fdbb2d 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .container {
            max-width: 100%;
            width: 100%;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }
        
        header {
            text-align: center;
            padding: 20px;
            background: #2c3e50;
            color: white;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .status {
            background-color: #f8f9fa;
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #e9ecef;
        }
        
        .distance-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
        }
        
        .distance-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: #3498db;
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }
        
        .distance-value {
            font-size: 2rem;
            font-weight: bold;
        }
        
        .distance-unit {
            font-size: 1rem;
        }
        
        .direction-info {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 15px 0;
        }
        
        .direction-arrow {
            font-size: 3rem;
            margin: 0 15px;
            color: #3498db;
        }
        
        .direction-text {
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .closest-poi {
            margin-top: 20px;
            padding: 15px;
            background: #e8f4fc;
            border-radius: 10px;
            text-align: center;
        }
        
        .content {
            padding: 20px;
        }
        
        .poi-info {
            display: none;
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .poi-info.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .image-gallery {
            position: relative;
            margin-bottom: 20px;
        }
        
        .gallery-main-image {
            width: 100%;
            height: 300px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .gallery-thumbnails {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding-bottom: 10px;
        }
        
        .gallery-thumbnail {
            width: 80px;
            height: 60px;
            object-fit: cover;
            border-radius: 5px;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }
        
        .gallery-thumbnail:hover, .gallery-thumbnail.active {
            opacity: 1;
        }
        
        .gallery-nav {
            position: absolute;
            top: 50%;
            width: 100%;
            display: flex;
            justify-content: space-between;
            transform: translateY(-50%);
            padding: 0 10px;
        }
        
        .gallery-btn {
            background: rgba(255, 255, 255, 0.8);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            color: #2c3e50;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        .poi-title {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        
        .poi-description {
            margin-bottom: 20px;
            font-size: 1.1rem;
            line-height: 1.6;
            color: #555;
            min-height: 120px;
        }
        
        .audio-controls {
            margin: 20px 0;
            text-align: center;
        }
        
        .poi-list {
            margin-top: 30px;
        }
        
        .poi-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            align-items: center;
        }
        
        .poi-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }
        
        .poi-icon {
            width: 50px;
            height: 50px;
            background: #3498db;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 15px;
            color: white;
            font-size: 1.5rem;
        }
        
        .poi-item-content {
            flex: 1;
        }
        
        .poi-item h3 {
            margin-bottom: 5px;
            color: #2c3e50;
        }
        
        .poi-item p {
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .simulation-controls {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            text-align: center;
        }
        
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            cursor: pointer;
            margin: 0 10px;
            font-size: 1rem;
            transition: background 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
        }
        
        button:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @media (max-width: 600px) {
            .container {
                border-radius: 10px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            button {
                display: block;
                width: 100%;
                margin: 10px 0;
            }
            
            .gallery-main-image {
                height: 200px;
            }
            
            .distance-circle {
                width: 120px;
                height: 120px;
            }
            
            .distance-value {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>GPS Felfedező App</h1>
            <p>Fedezz fel érdekes helyeket a közeledben!</p>
        </header>
        
        <div class="status">
            <div class="distance-info">
                <div class="distance-circle">
                    <span id="distance-value" class="distance-value">--</span>
                    <span class="distance-unit">méter</span>
                </div>
                <div class="direction-info">
                    <i id="direction-arrow" class="fas fa-arrow-up direction-arrow"></i>
                    <span id="direction-text" class="direction-text">Keresés...</span>
                </div>
            </div>
            
            <div class="closest-poi">
                <h3 id="closest-poi-name">Legközelebbi érdekes pont</h3>
                <p id="closest-poi-distance">Az alkalmazás érzékeli a pozíciódat...</p>
            </div>
        </div>
        
        <div class="content">
            <div id="poi-info" class="poi-info">
                <div class="image-gallery">
                    <img id="gallery-main-image" class="gallery-main-image" src="" alt="POI image">
                    <div class="gallery-nav">
                        <button class="gallery-btn" id="prev-btn"><i class="fas fa-chevron-left"></i></button>
                        <button class="gallery-btn" id="next-btn"><i class="fas fa-chevron-right"></i></button>
                    </div>
                    <div class="gallery-thumbnails" id="gallery-thumbnails"></div>
                </div>
                
                <h2 id="poi-title" class="poi-title"></h2>
                <p id="poi-description" class="poi-description"></p>
                <div class="audio-controls">
                    <audio id="poi-audio" controls></audio>
                </div>
                <button id="close-poi">Bezárás</button>
            </div>
            
            <div class="simulation-controls">
                <h2>Helyszín kipróbálása</h2>
                <p>Válassz egy helyszínt a teszteléshez:</p>
                <button id="simulate-buda">Budai Vár</button>
                <button id="simulate-halaszbastya">Halászbástya</button>
                <button id="simulate-lanchid">Lánchíd</button>
            </div>
        </div>
        
        <footer>
            <p>© 2023 GPS Felfedező App | Fedezd fel a világot!</p>
        </footer>
    </div>

    <script>
        // Koordináta konverzió: 46°14'43.82"É, 20° 9'27.32"K
        function dmsToDecimal(degrees, minutes, seconds, direction) {
            let decimal = degrees + minutes / 60 + seconds / 3600;
            if (direction === 'S' || direction === 'W') {
                decimal = -decimal;
            }
            return decimal;
        }
        
        // Budai Vár koordinátái: 46°14'43.82"É, 20° 9'27.32"K
        const budaiVarLat = dmsToDecimal(46, 14, 43.82, 'N');
        const budaiVarLng = dmsToDecimal(20, 9, 27.32, 'E');

        // Előre meghatározott érdekes pontok (POI-k) több képpel
        const pointsOfInterest = [
            {
                id: 1,
                name: "Budai Vár",
                lat: budaiVarLat,
                lng: budaiVarLng,
                radius: 100,
                images: [
                    "https://www.hetedhetorszag.hu/parameters/hetedhetorszag/modules/Attractions/documents/attraction/32816/image/9834/large.jpg",
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/3/3d/Budavari_palota_2016.jpg/800px-Budavari_palota_2016.jpg",
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/6/6f/Budapest_-_Buda_Castle2.jpg/800px-Budapest_-_Buda_Castle2.jpg"
                ],
                description: "A Budai Várnegyed a Duna jobb partján, a Várhegy tetején terül el. Több mint 700 éves múltra tekint vissza, és Budapest egyik leglátogatottabb nevezetessége. A történelmi palota és a középkori utcák egyedülálló atmoszférát teremtenek.",
                audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"
            },
            {
                id: 2,
                name: "Halászbástya",
                lat: 47.5020,
                lng: 19.0337,
                radius: 50,
                images: [
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Hal%C3%A1szb%C3%A1stya_2017.jpg/800px-Hal%C3%A1szb%C3%A1stya_2017.jpg",
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Hal%C3%A1szb%C3%A1stya_a_Szenth%C3%A1roms%C3%A1g_szobr%C3%A1val.jpg/800px-Hal%C3%A1szb%C3%A1stya_a_Szenth%C3%A1roms%C3%A1g_szobr%C3%A1val.jpg",
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/9/9a/Hal%C3%A1szb%C3%A1stya_%282%29.jpg/800px-Hal%C3%A1szb%C3%A1stya_%282%29.jpg"
                ],
                description: "A Halászbástya Budapest egyik legismertebb látványossága, a Várnegyedben található. 1905-ben épült, neoromán stílusban. Kilátótornyaiból lenyűgöző panoráma nyílik a városra és a Dunara.",
                audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3"
            },
            {
                id: 3,
                name: "Széchenyi Lánchíd",
                lat: 47.4986,
                lng: 19.0439,
                radius: 80,
                images: [
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Sz%C3%A9chenyi_Chain_Bridge_%28Budapest%29.jpg/800px-Sz%C3%A9chenyi_Chain_Bridge_%28Budapest%29.jpg",
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/0/00/2015_Budapest_-_Sz%C3%A9chenyi_L%C3%A1nch%C3%ADd_2.jpg/800px-2015_Budapest_-_Sz%C3%A9chenyi_L%C3%A1nch%C3%ADd_2.jpg",
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/4/4a/Budapest_Chain_Bridge_at_night.jpg/800px-Budapest_Chain_Bridge_at_night.jpg"
                ],
                description: "A Széchenyi lánchíd Budapest legrégebbi és legismertebb hidja, amely Budát és Pestet köti össze. 1849-ben adták át a forgalomnak. Az úttörő mérnöki alkotás ma is a város egyik szimbóluma.",
                audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3"
            }
        ];

        // Alkalmazás állapota
        let currentPosition = null;
        let watchId = null;
        let currentPoi = null;
        let currentImageIndex = 0;
        let closestPoi = null;

        // Elemek kiválasztása
        const distanceValue = document.getElementById('distance-value');
        const directionArrow = document.getElementById('direction-arrow');
        const directionText = document.getElementById('direction-text');
        const closestPoiName = document.getElementById('closest-poi-name');
        const closestPoiDistance = document.getElementById('closest-poi-distance');
        const poiInfo = document.getElementById('poi-info');
        const galleryMainImage = document.getElementById('gallery-main-image');
        const galleryThumbnails = document.getElementById('gallery-thumbnails');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const poiTitle = document.getElementById('poi-title');
        const poiDescription = document.getElementById('poi-description');
        const poiAudio = document.getElementById('poi-audio');
        const closePoiButton = document.getElementById('close-poi');

        // Szimulációs gombok
        const simulateBuda = document.getElementById('simulate-buda');
        const simulateHalaszbastya = document.getElementById('simulate-halaszbastya');
        const simulateLanchid = document.getElementById('simulate-lanchid');

        // Irány és távolság frissítése
        function updateDirectionAndDistance() {
            if (!currentPosition || !closestPoi) return;
            
            const { latitude, longitude } = currentPosition.coords;
            const distance = calculateDistance(
                latitude, longitude, 
                closestPoi.lat, closestPoi.lng
            );
            
            // Távolság frissítése
            distanceValue.textContent = Math.round(distance);
            
            // Irány frissítése
            const bearing = calculateBearing(
                latitude, longitude,
                closestPoi.lat, closestPoi.lng
            );
            
            updateDirectionArrow(bearing);
            
            // Szöveges információ frissítése
            closestPoiName.textContent = closestPoi.name;
            closestPoiDistance.textContent = `${Math.round(distance)} méterre tőled`;
        }
        
        // Iránymutató frissítése
        function updateDirectionArrow(bearing) {
            // Szög normalizálása 0-360 fok között
            const normalizedBearing = (bearing + 360) % 360;
            
            // Irány szöveges leírása
            let direction = "";
            if (normalizedBearing >= 337.5 || normalizedBearing < 22.5) {
                direction = "Észak";
                directionArrow.className = "fas fa-arrow-up direction-arrow";
            } else if (normalizedBearing >= 22.5 && normalizedBearing < 67.5) {
                direction = "Északkelet";
                directionArrow.className = "fas fa-arrow-up-right direction-arrow";
            } else if (normalizedBearing >= 67.5 && normalizedBearing < 112.5) {
                direction = "Kelet";
                directionArrow.className = "fas fa-arrow-right direction-arrow";
            } else if (normalizedBearing >= 112.5 && normalizedBearing < 157.5) {
                direction = "Délkelet";
                directionArrow.className = "fas fa-arrow-down-right direction-arrow";
            } else if (normalizedBearing >= 157.5 && normalizedBearing < 202.5) {
                direction = "Dél";
                directionArrow.className = "fas fa-arrow-down direction-arrow";
            } else if (normalizedBearing >= 202.5 && normalizedBearing < 247.5) {
                direction = "Délnyugat";
                directionArrow.className = "fas fa-arrow-down-left direction-arrow";
            } else if (normalizedBearing >= 247.5 && normalizedBearing < 292.5) {
                direction = "Nyugat";
                directionArrow.className = "fas fa-arrow-left direction-arrow";
            } else if (normalizedBearing >= 292.5 && normalizedBearing < 337.5) {
                direction = "Északnyugat";
                directionArrow.className = "fas fa-arrow-up-left direction-arrow";
            }
            
            directionText.textContent = direction + " irányában";
        }
        
        // Irányszög számítása két koordináta között
        function calculateBearing(lat1, lon1, lat2, lon2) {
            const φ1 = deg2rad(lat1);
            const φ2 = deg2rad(lat2);
            const Δλ = deg2rad(lon2 - lon1);
            
            const y = Math.sin(Δλ) * Math.cos(φ2);
            const x = Math.cos(φ1) * Math.sin(φ2) - Math.sin(φ1) * Math.cos(φ2) * Math.cos(Δλ);
            const θ = Math.atan2(y, x);
            
            return (rad2deg(θ) + 360) % 360;
        }
        
        function rad2deg(rad) {
            return rad * 180 / Math.PI;
        }

        // Képgaléria inicializálása
        function initGallery(poi) {
            galleryThumbnails.innerHTML = '';
            currentImageIndex = 0;
            
            if (poi.images && poi.images.length > 0) {
                galleryMainImage.src = poi.images[0];
                
                // Bélyegképek létrehozása
                poi.images.forEach((image, index) => {
                    const thumb = document.createElement('img');
                    thumb.src = image;
                    thumb.alt = `Thumbnail ${index + 1}`;
                    thumb.className = 'gallery-thumbnail';
                    if (index === 0) thumb.classList.add('active');
                    
                    thumb.addEventListener('click', () => {
                        currentImageIndex = index;
                        updateGallery(poi);
                    });
                    
                    galleryThumbnails.appendChild(thumb);
                });
                
                // Navigációs gombok eseménykezelői
                prevBtn.onclick = () => {
                    currentImageIndex = (currentImageIndex - 1 + poi.images.length) % poi.images.length;
                    updateGallery(poi);
                };
                
                nextBtn.onclick = () => {
                    currentImageIndex = (currentImageIndex + 1) % poi.images.length;
                    updateGallery(poi);
                };
            }
        }
        
        // Galéria frissítése
        function updateGallery(poi) {
            galleryMainImage.src = poi.images[currentImageIndex];
            
            // Aktív bélyegkép frissítése
            const thumbs = galleryThumbnails.querySelectorAll('.gallery-thumbnail');
            thumbs.forEach((thumb, index) => {
                if (index === currentImageIndex) {
                    thumb.classList.add('active');
                } else {
                    thumb.classList.remove('active');
                }
            });
        }

        // Helymeghatározás inicializálása
        function initGeolocation() {
            if (!navigator.geolocation) {
                directionText.textContent = "A böngésző nem támogatja a helymeghatározást";
                return;
            }
            
            // Pozíció változás figyelése
            watchId = navigator.geolocation.watchPosition(
                position => {
                    currentPosition = position;
                    checkForNearbyPois();
                    updateDirectionAndDistance();
                },
                error => {
                    directionText.textContent = "Helymeghatározás nem elérhető";
                },
                {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 60000
                }
            );
        }

        // Közeledben lévő POI-k ellenőrzése
        function checkForNearbyPois() {
            if (!currentPosition) return;
            
            const { latitude, longitude } = currentPosition.coords;
            let minDistance = Infinity;
            let newClosestPoi = null;
            
            pointsOfInterest.forEach(poi => {
                const distance = calculateDistance(
                    latitude, longitude, 
                    poi.lat, poi.lng
                );
                
                if (distance < minDistance) {
                    minDistance = distance;
                    newClosestPoi = poi;
                }
                
                // Ha a felhasználó elég közel van egy POI-hoz
                if (distance <= poi.radius && currentPoi !== poi.id) {
                    currentPoi = poi.id;
                    showPoiInfo(poi);
                }
            });
            
            closestPoi = newClosestPoi;
        }

        // Két koordináta közötti távolság számítása (Haversine formula)
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371000; // Föld sugara méterben
            const dLat = deg2rad(lat2 - lat1);
            const dLon = deg2rad(lon2 - lon1);
            const a = 
                Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * 
                Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            const distance = R * c;
            return distance;
        }

        function deg2rad(deg) {
            return deg * (Math.PI/180);
        }

        // POI információk megjelenítése
        function showPoiInfo(poi) {
            poiTitle.textContent = poi.name;
            poiDescription.textContent = poi.description;
            poiAudio.src = poi.audio;
            
            initGallery(poi);
            poiInfo.classList.add('active');
            
            // Hang automatikus lejátszása
            setTimeout(() => {
                poiAudio.play().catch(e => {
                    console.log("Automatikus hanglejátszás nem engedélyezett");
                });
            }, 500);
        }

        // Szimulációs funkciók
        simulateBuda.addEventListener('click', () => {
            simulatePosition(budaiVarLat, budaiVarLng, "Budai Vár");
        });

        simulateHalaszbastya.addEventListener('click', () => {
            simulatePosition(47.5020, 19.0337, "Halászbástya");
        });

        simulateLanchid.addEventListener('click', () => {
            simulatePosition(47.4986, 19.0439, "Széchenyi Lánchíd");
        });

        function simulatePosition(lat, lng, name) {
            // Szimuláljunk egy pozíciót
            currentPosition = {
                coords: {
                    latitude: lat,
                    longitude: lng,
                    accuracy: 10
                }
            };
            
            checkForNearbyPois();
            updateDirectionAndDistance();
        }

        // Bezárás gomb eseménykezelő
        closePoiButton.addEventListener('click', () => {
            poiInfo.classList.remove('active');
            poiAudio.pause();
        });

        // Alkalmazás inicializálása
        function initApp() {
            initGeolocation();
        }

        // Alkalmazás indítása
        initApp();
    </script>
</body>
</html>
