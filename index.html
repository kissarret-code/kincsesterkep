<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPS Felfedez≈ë App</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c 0%, #b21f1f 50%, #fdbb2d 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .container {
            max-width: 100%;
            width: 100%;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 97vh;
        }
        
        header {
            text-align: center;
            padding: 15px;
            background: #2c3e50;
            color: white;
            position: relative;
        }
        
        .nav-status {
            position: absolute;
            top: 10px;
            right: 15px;
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
        }
        
        .nav-status.active {
            background: rgba(46, 204, 113, 0.3);
        }
        
        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #e74c3c;
            margin-right: 5px;
        }
        
        .status-dot.active {
            background: #2ecc71;
            animation: pulse 1.5s infinite;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 8px;
        }
        
        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .tab-container {
            display: flex;
            border-bottom: 1px solid #ddd;
            background: #f8f9fa;
        }
        
        .tab {
            padding: 15px 20px;
            cursor: pointer;
            font-weight: bold;
            color: #7f8c8d;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            color: #3498db;
            border-bottom: 3px solid #3498db;
            background: white;
        }
        
        .tab-content {
            flex: 1;
            overflow-y: auto;
            display: none;
            padding: 20px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .poi-info {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .poi-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .thumbnail-image {
            width: 120px;
            height: 90px;
            object-fit: cover;
            border-radius: 8px;
            margin-right: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }
        
        .poi-title {
            font-size: 2.2rem;
            color: #2c3e50;
            flex: 1;
        }
        
        .poi-description {
            margin-bottom: 25px;
            font-size: 1.3rem;
            line-height: 1.8;
            color: #555;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 10px;
            text-align: justify;
        }
        
        .audio-controls {
            margin: 30px 0;
            text-align: center;
            padding: 15px;
            background: #f0f8ff;
            border-radius: 10px;
        }
        
        .audio-controls audio {
            width: 100%;
            height: 50px;
        }
        
        .image-gallery {
            position: relative;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #eee;
        }
        
        .gallery-main-image {
            width: 100%;
            height: 350px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .gallery-thumbnails {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding-bottom: 10px;
        }
        
        .gallery-thumbnail {
            width: 100px;
            height: 75px;
            object-fit: cover;
            border-radius: 5px;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }
        
        .gallery-thumbnail:hover, .gallery-thumbnail.active {
            opacity: 1;
        }
        
        .gallery-nav {
            position: absolute;
            top: 50%;
            width: 100%;
            display: flex;
            justify-content: space-between;
            transform: translateY(-50%);
            padding: 0 15px;
        }
        
        .gallery-btn {
            background: rgba(255, 255, 255, 0.9);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.5rem;
            color: #2c3e50;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
        }
        
        .gallery-btn:hover {
            background: rgba(255, 255, 255, 1);
            transform: scale(1.1);
        }
        
        .distance-info {
            display: flex;
            flex-direction: column;
        }
        
        .distance-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            background: white;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .distance-item.reached {
            background: #e8f5e9;
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
            transform: scale(1.02);
        }
        
        .poi-name {
            font-weight: bold;
            font-size: 1.3rem;
            color: #2c3e50;
        }
        
        .distance-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #3498db;
        }
        
        .distance-unit {
            font-size: 1rem;
            color: #7f8c8d;
        }
        
        .simulation-controls {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            text-align: center;
        }
        
        .simulation-title {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 14px 25px;
            border-radius: 50px;
            cursor: pointer;
            margin: 8px;
            font-size: 1.1rem;
            transition: background 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
        }
        
        button:hover {
            background: #2980b9;
            transform: translateY(-3px);
        }
        
        #close-poi {
            background: #e74c3c;
            display: block;
            margin: 20px auto;
            padding: 12px 25px;
        }
        
        footer {
            text-align: center;
            padding: 12px;
            color: #7f8c8d;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
            font-size: 0.9rem;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        @media (max-width: 600px) {
            .container {
                border-radius: 10px;
                height: 97vh;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .nav-status {
                top: 5px;
                right: 10px;
                font-size: 0.8rem;
            }
            
            .tab {
                padding: 12px 15px;
                font-size: 0.9rem;
            }
            
            .poi-header {
                flex-direction: column;
                text-align: center;
            }
            
            .thumbnail-image {
                margin-right: 0;
                margin-bottom: 15px;
                width: 100%;
                max-width: 200px;
            }
            
            .gallery-main-image {
                height: 250px;
            }
            
            .gallery-btn {
                width: 40px;
                height: 40px;
                font-size: 1.2rem;
            }
            
            .gallery-thumbnail {
                width: 80px;
                height: 60px;
            }
            
            .poi-title {
                font-size: 1.8rem;
            }
            
            .poi-description {
                font-size: 1.1rem;
            }
            
            .distance-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .distance-value {
                margin-top: 5px;
                align-self: flex-end;
            }
            
            button {
                display: block;
                width: 100%;
                margin: 10px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>GPS Felfedez≈ë App</h1>
            <p>Fedezz fel √©rdekes helyeket a k√∂zeledben!</p>
            <div class="nav-status" id="nav-status">
                <div class="status-dot" id="status-dot"></div>
                <span id="status-text">Navig√°ci√≥ inakt√≠v</span>
            </div>
        </header>
        
        <div class="content">
            <div class="main-content">
                <div class="tab-container">
                    <div class="tab active" data-tab="poi">Helysz√≠n inform√°ci√≥k</div>
                    <div class="tab" data-tab="distance">T√°vols√°gok</div>
                </div>
                
                <div class="tab-content active" id="poi-tab">
                    <div class="poi-info">
                        <div class="poi-header">
                            <img id="thumbnail-image" class="thumbnail-image" src="" alt="POI thumbnail">
                            <h2 id="poi-title" class="poi-title"></h2>
                        </div>
                        
                        <p id="poi-description" class="poi-description"></p>
                        
                        <div class="audio-controls">
                            <audio id="poi-audio" controls></audio>
                        </div>
                        
                        <div class="image-gallery">
                            <img id="gallery-main-image" class="gallery-main-image" src="" alt="POI image">
                            <div class="gallery-nav">
                                <button class="gallery-btn" id="prev-btn"><i class="fas fa-chevron-left"></i></button>
                                <button class="gallery-btn" id="next-btn"><i class="fas fa-chevron-right"></i></button>
                            </div>
                            <div class="gallery-thumbnails" id="gallery-thumbnails"></div>
                        </div>
                        
                        <button id="close-poi">Bez√°r√°s</button>
                    </div>
                    
                    <div class="simulation-controls">
                        <h2 class="simulation-title">Helysz√≠n kipr√≥b√°l√°sa</h2>
                        <p>V√°lassz egy helysz√≠nt a tesztel√©shez:</p>
                        <button id="simulate-buda">Budai V√°r</button>
                        <button id="simulate-halaszbastya">Hal√°szb√°stya</button>
                        <button id="simulate-lanchid">L√°nch√≠d</button>
                    </div>
                </div>
                
                <div class="tab-content" id="distance-tab">
                    <div class="welcome-message">
                        <h3>K√∂zeledben l√©v≈ë √©rdekes helyek</h3>
                        <p>Az al√°bbi lista mutatja, hogy milyen messze van a k√∂zeledben l√©v≈ë √©rdekes helyekt≈ël.</p>
                    </div>
                    
                    <div class="distance-info" id="distance-info">
                        <!-- A t√°vols√°g inform√°ci√≥k ide fognak ker√ºlni -->
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>¬© 2023 GPS Felfedez≈ë App | Fedezd fel a vil√°got!</p>
        </footer>
    </div>

    <script>
        // Koordin√°ta konverzi√≥ f√ºggv√©ny
        function dmsToDecimal(degrees, minutes, seconds, direction) {
            let decimal = degrees + minutes / 60 + seconds / 3600;
            if (direction === 'S' || direction === 'W') {
                decimal = -decimal;
            }
            return decimal;
        }
        
        // Budai V√°r koordin√°t√°i: 46¬∞14'43.82"√â, 20¬∞ 9'27.32"K
        const budaiVarLat = dmsToDecimal(46, 14, 43.82, 'N');
        const budaiVarLng = dmsToDecimal(20, 9, 27.32, 'E');
        
        // Hal√°szb√°stya koordin√°t√°i: 46¬∞15'32.36"√â, 20¬∞ 9'59.65"K
        const halaszbastyaLat = dmsToDecimal(46, 15, 32.36, 'N');
        const halaszbastyaLng = dmsToDecimal(20, 9, 59.65, 'E');

        // El≈ëre meghat√°rozott √©rdekes pontok (POI-k) t√∂bb k√©ppel
        const pointsOfInterest = [
            {
                id: 1,
                name: "Budai V√°r",
                lat: budaiVarLat,
                lng: budaiVarLng,
                radius: 100,
                images: [
                    "https://www.hetedhetorszag.hu/parameters/hetedhetorszag/modules/Attractions/documents/attraction/32816/image/9834/large.jpg",
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/3/3d/Budavari_palota_2016.jpg/800px-Budavari_palota_2016.jpg",
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/6/6f/Budapest_-_Buda_Castle2.jpg/800px-Budapest_-_Buda_Castle2.jpg"
                ],
                description: "A Budai V√°rnegyed a Duna jobb partj√°n, a V√°rhegy tetej√©n ter√ºl el. T√∂bb mint 700 √©ves m√∫ltra tekint vissza, √©s Budapest egyik legl√°togatottabb nevezetess√©ge. A t√∂rt√©nelmi palota √©s a k√∂z√©pkori utc√°k egyed√ºl√°ll√≥ atmoszf√©r√°t teremtenek. A v√°rkomplexum t√∂bb m√∫zeumnak, gal√©ri√°nak √©s k√∂nyvt√°rnak ad otthont, √©s gy√∂ny√∂r≈± kil√°t√°st ny√∫jt a v√°rosra.",
                audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"
            },
            {
                id: 2,
                name: "Hal√°szb√°stya",
                lat: halaszbastyaLat,
                lng: halaszbastyaLng,
                radius: 50,
                images: [
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Hal%C3%A1szb%C3%A1stya_2017.jpg/800px-Hal%C3%A1szb%C3%A1stya_2017.jpg",
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Hal%C3%A1szb%C3%A1stya_a_Szenth%C3%A1roms%C3%A1g_szobr%C3%A1val.jpg/800px-Hal%C3%A1szb%C3%A1stya_a_Szenth%C3%A1roms%C3%A1g_szobr%C3%A1val.jpg",
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/9/9a/Hal%C3%A1szb%C3%A1stya_%282%29.jpg/800px-Hal%C3%A1szb%C3%A1stya_%282%29.jpg"
                ],
                description: "A Hal√°szb√°stya Budapest egyik legismertebb l√°tv√°nyoss√°ga, a V√°rnegyedben tal√°lhat√≥. 1905-ben √©p√ºlt, neorom√°n st√≠lusban. Kil√°t√≥tornyaib√≥l leny≈±g√∂z≈ë panor√°ma ny√≠lik a v√°rosra √©s a Dunara. A Hal√°szb√°stya neve a k√∂z√©pkori hal√°szc√©hre utal, akik a v√°rfalak v√©delm√©vel voltak megb√≠zva. A teraszair√≥l pazar kil√°t√°s ny√≠lik a pesti oldalra √©s a Margaret-szigetre.",
                audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3"
            },
            {
                id: 3,
                name: "Sz√©chenyi L√°nch√≠d",
                lat: 47.4986,
                lng: 19.0439,
                radius: 80,
                images: [
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Sz%C3%A9chenyi_Chain_Bridge_%28Budapest%29.jpg/800px-Sz%C3%A9chenyi_Chain_Bridge_%28Budapest%29.jpg",
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/0/00/2015_Budapest_-_Sz%C3%A9chenyi_L%C3%A1nch%C3%ADd_2.jpg/800px-2015_Budapest_-_Sz%C3%A9chenyi_L%C3%A1nch%C3%EDd_2.jpg",
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/4/4a/Budapest_Chain_Bridge_at_night.jpg/800px-Budapest_Chain_Bridge_at_night.jpg"
                ],
                description: "A Sz√©chenyi l√°nch√≠d Budapest legr√©gebbi √©s legismertebb hidja, amely Bud√°t √©s Pestet k√∂ti √∂ssze. 1849-ben adt√°k √°t a forgalomnak. Az √∫tt√∂r≈ë m√©rn√∂ki alkot√°s ma is a v√°ros egyik szimb√≥luma. A hidat Sz√©chenyi Istv√°n gr√≥f kezdem√©nyez√©s√©re √©p√≠tett√©k, √©s nev√©vel is ≈ët tisztelik. Az √©p√≠tkez√©s sor√°n sz√°mos technikai √∫j√≠t√°st alkalmaztak, √©s a h√≠d meg√©p√≠t√©se jelent≈ës nemzeti √ºggy√© v√°lt.",
                audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3"
            }
        ];

        // Alkalmaz√°s √°llapota
        let currentPosition = null;
        let watchId = null;
        let currentPoi = null;
        let currentImageIndex = 0;
        let isNavigationActive = false;
        let currentAudio = null;

        // Elemek kiv√°laszt√°sa
        const navStatus = document.getElementById('nav-status');
        const statusDot = document.getElementById('status-dot');
        const statusText = document.getElementById('status-text');
        const distanceInfo = document.getElementById('distance-info');
        const thumbnailImage = document.getElementById('thumbnail-image');
        const poiTitle = document.getElementById('poi-title');
        const poiDescription = document.getElementById('poi-description');
        const poiAudio = document.getElementById('poi-audio');
        const galleryMainImage = document.getElementById('gallery-main-image');
        const galleryThumbnails = document.getElementById('gallery-thumbnails');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const closePoiButton = document.getElementById('close-poi');
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');

        // Szimul√°ci√≥s gombok
        const simulateBuda = document.getElementById('simulate-buda');
        const simulateHalaszbastya = document.getElementById('simulate-halaszbastya');
        const simulateLanchid = document.getElementById('simulate-lanchid');

        // Hang lej√°tsz√°s√°nak kezel√©se
        function playAudio(audioUrl) {
            // El≈ëz≈ë hang le√°ll√≠t√°sa
            if (currentAudio) {
                currentAudio.pause();
                currentAudio = null;
            }
            
            // √öj hang lej√°tsz√°sa
            const audio = new Audio(audioUrl);
            audio.play().catch(e => {
                console.log("Automatikus hanglej√°tsz√°s nem enged√©lyezett: ", e);
            });
            currentAudio = audio;
        }

        // Tab v√°lt√°s
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.getAttribute('data-tab');
                
                // Tab aktiv√°l√°sa
                tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                // Tartalom megjelen√≠t√©se
                tabContents.forEach(content => content.classList.remove('active'));
                document.getElementById(`${tabId}-tab`).classList.add('active');
            });
        });

        // Navig√°ci√≥ st√°tusz friss√≠t√©se
        function updateNavigationStatus(active) {
            isNavigationActive = active;
            
            if (active) {
                navStatus.classList.add('active');
                statusDot.classList.add('active');
                statusText.textContent = 'Navig√°ci√≥ akt√≠v';
            } else {
                navStatus.classList.remove('active');
                statusDot.classList.remove('active');
                statusText.textContent = 'Navig√°ci√≥ inakt√≠v';
            }
        }

        // T√°vols√°g inform√°ci√≥k friss√≠t√©se
        function updateDistanceInfo() {
            if (!currentPosition) return;
            
            const { latitude, longitude } = currentPosition.coords;
            
            // T√°vols√°g inform√°ci√≥k l√©trehoz√°sa/friss√≠t√©se
            distanceInfo.innerHTML = '';
            
            pointsOfInterest.forEach(poi => {
                const distance = calculateDistance(
                    latitude, longitude, 
                    poi.lat, poi.lng
                );
                
                const distanceElement = document.createElement('div');
                distanceElement.className = 'distance-item';
                
                // Ha a felhaszn√°l√≥ a hat√≥sug√°ron bel√ºl van
                if (distance <= poi.radius) {
                    distanceElement.classList.add('reached');
                }
                
                distanceElement.innerHTML = `
                    <span class="poi-name">${poi.name}</span>
                    <span class="distance-value">${Math.round(distance)} <span class="distance-unit">m</span></span>
                `;
                
                distanceInfo.appendChild(distanceElement);
            });
        }

        // K√©pgal√©ria inicializ√°l√°sa
        function initGallery(poi) {
            galleryThumbnails.innerHTML = '';
            currentImageIndex = 0;
            
            if (poi.images && poi.images.length > 0) {
                // B√©lyegk√©p be√°ll√≠t√°sa
                thumbnailImage.src = poi.images[0];
                
                // F≈ë k√©p be√°ll√≠t√°sa
                galleryMainImage.src = poi.images[0];
                
                // B√©lyegk√©pek l√©trehoz√°sa
                poi.images.forEach((image, index) => {
                    const thumb = document.createElement('img');
                    thumb.src = image;
                    thumb.alt = `Thumbnail ${index + 1}`;
                    thumb.className = 'gallery-thumbnail';
                    if (index === 0) thumb.classList.add('active');
                    
                    thumb.addEventListener('click', () => {
                        currentImageIndex = index;
                        updateGallery(poi);
                    });
                    
                    galleryThumbnails.appendChild(thumb);
                });
                
                // Navig√°ci√≥s gombok esem√©nykezel≈ëi
                prevBtn.onclick = () => {
                    currentImageIndex = (currentImageIndex - 1 + poi.images.length) % poi.images.length;
                    updateGallery(poi);
                };
                
                nextBtn.onclick = () => {
                    currentImageIndex = (currentImageIndex + 1) % poi.images.length;
                    updateGallery(poi);
                };
            }
        }
        
        // Gal√©ria friss√≠t√©se
        function updateGallery(poi) {
            galleryMainImage.src = poi.images[currentImageIndex];
            
            // Akt√≠v b√©lyegk√©p friss√≠t√©se
            const thumbs = galleryThumbnails.querySelectorAll('.gallery-thumbnail');
            thumbs.forEach((thumb, index) => {
                if (index === currentImageIndex) {
                    thumb.classList.add('active');
                } else {
                    thumb.classList.remove('active');
                }
            });
        }

        // Helymeghat√°roz√°s inicializ√°l√°sa
        function initGeolocation() {
            if (!navigator.geolocation) {
                distanceInfo.innerHTML = '<p>A b√∂ng√©sz≈ë nem t√°mogatja a helymeghat√°roz√°st</p>';
                updateNavigationStatus(false);
                return;
            }
            
            updateNavigationStatus(true);
            
            // Poz√≠ci√≥ v√°ltoz√°s figyel√©se
            watchId = navigator.geolocation.watchPosition(
                position => {
                    currentPosition = position;
                    checkForNearbyPois();
                    updateDistanceInfo();
                    updateNavigationStatus(true);
                },
                error => {
                    distanceInfo.innerHTML = '<p>Helymeghat√°roz√°s nem el√©rhet≈ë</p>';
                    updateNavigationStatus(false);
                },
                {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 60000
                }
            );
        }

        // K√∂zeledben l√©v≈ë POI-k ellen≈ërz√©se
        function checkForNearbyPois() {
            if (!currentPosition) return;
            
            const { latitude, longitude } = currentPosition.coords;
            
            pointsOfInterest.forEach(poi => {
                const distance = calculateDistance(
                    latitude, longitude, 
                    poi.lat, poi.lng
                );
                
                // Ha a felhaszn√°l√≥ el√©g k√∂zel van egy POI-hoz
                if (distance <= poi.radius && currentPoi !== poi.id) {
                    currentPoi = poi.id;
                    showPoiInfo(poi);
                    
                    // Hang automatikus lej√°tsz√°sa
                    playAudio(poi.audio);
                }
            });
        }

        // K√©t koordin√°ta k√∂z√∂tti t√°vols√°g sz√°m√≠t√°sa (Haversine formula)
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371000; // F√∂ld sugara m√©terben
            const dLat = deg2rad(lat2 - lat1);
            const dLon = deg2rad(lon2 - lon1);
            const a = 
                Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * 
                Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            const distance = R * c;
            return distance;
        }

        function deg2rad(deg) {
            return deg * (Math.PI/180);
        }

        // POI inform√°ci√≥k megjelen√≠t√©se
        function showPoiInfo(poi) {
            poiTitle.textContent = poi.name;
            poiDescription.textContent = poi.description;
            poiAudio.src = poi.audio;
            
            initGallery(poi);
            
            // V√°lt√°s a POI tabra
            tabs.forEach(t => t.classList.remove('active'));
            document.querySelector('[data-tab="poi"]').classList.add('active');
            
            tabContents.forEach(content => content.classList.remove('active'));
            document.getElementById('poi-tab').classList.add('active');
        }

        // Szimul√°ci√≥s funkci√≥k
        simulateBuda.addEventListener('click', () => {
            simulatePosition(budaiVarLat, budaiVarLng, "Budai V√°r");
        });

        simulateHalaszbastya.addEventListener('click', () => {
            simulatePosition(halaszbastyaLat, halaszbastyaLng, "Hal√°szb√°stya");
        });

        simulateLanchid.addEventListener('click', () => {
            simulatePosition(47.4986, 19.0439, "Sz√©chenyi L√°nch√≠d");
        });

        function simulatePosition(lat, lng, name) {
            // Szimul√°ljunk egy poz√≠ci√≥t
            currentPosition = {
                coords: {
                    latitude: lat,
                    longitude: lng,
                    accuracy: 10
                }
            };
            
            checkForNearbyPois();
            updateDistanceInfo();
            updateNavigationStatus(true);
        }

        // Bez√°r√°s gomb esem√©nykezel≈ë
        closePoiButton.addEventListener('click', () => {
            // V√°lt√°s a t√°vols√°gok tabra
            tabs.forEach(t => t.classList.remove('active'));
            document.querySelector('[data-tab="distance"]').classList.add('active');
            
            tabContents.forEach(content => content.classList.remove('active'));
            document.getElementById('distance-tab').classList.add('active');
            
            // Hang le√°ll√≠t√°sa
            if (currentAudio) {
                currentAudio.pause();
                currentAudio = null;
            }
        });

        // Alkalmaz√°s inicializ√°l√°sa
        function initApp() {
            initGeolocation();
        }

        // Alkalmaz√°s ind√≠t√°sa
        initApp();
    </script>
</body>
</html>
