<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPS Felfedező App</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c 0%, #b21f1f 50%, #fdbb2d 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .container {
            max-width: 100%;
            width: 100%;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 95vh;
        }
        
        header {
            text-align: center;
            padding: 20px;
            background: #2c3e50;
            color: white;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .poi-content {
            flex: 3; /* Nagyobb részarány a felső résznek */
            overflow-y: auto;
            padding: 20px;
        }
        
        .poi-info {
            display: none;
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .poi-info.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        .image-gallery {
            position: relative;
            margin-bottom: 20px;
        }
        
        .gallery-main-image {
            width: 100%;
            height: 350px; /* Nagyobb kép */
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .gallery-thumbnails {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding-bottom: 10px;
        }
        
        .gallery-thumbnail {
            width: 100px; /* Nagyobb bélyegképek */
            height: 75px;
            object-fit: cover;
            border-radius: 5px;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }
        
        .gallery-thumbnail:hover, .gallery-thumbnail.active {
            opacity: 1;
        }
        
        .gallery-nav {
            position: absolute;
            top: 50%;
            width: 100%;
            display: flex;
            justify-content: space-between;
            transform: translateY(-50%);
            padding: 0 10px;
        }
        
        .gallery-btn {
            background: rgba(255, 255, 255, 0.8);
            border: none;
            width: 50px; /* Nagyobb gombok */
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.5rem; /* Nagyobb ikonok */
            color: #2c3e50;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        .poi-title {
            font-size: 2rem; /* Nagyobb cím */
            margin-bottom: 20px;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        
        .poi-description {
            margin-bottom: 25px;
            font-size: 1.2rem; /* Nagyobb szöveg */
            line-height: 1.7;
            color: #555;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 8px;
        }
        
        .audio-controls {
            margin: 25px 0;
            text-align: center;
        }
        
        .audio-controls audio {
            width: 100%; /* Teljes szélességű audio lejátszó */
        }
        
        .distance-container {
            background-color: #f8f9fa;
            padding: 15px;
            border-top: 1px solid #e9ecef;
            flex: 1; /* Kisebb részarány az alsó résznek */
        }
        
        .welcome-message {
            text-align: center;
            padding: 10px;
            font-size: 1.1rem;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .distance-info {
            display: flex;
            flex-direction: column;
        }
        
        .distance-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            padding: 12px 15px;
            margin: 8px 0;
            background: white;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .distance-item.reached {
            background: #e8f5e9;
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }
        
        .poi-name {
            font-weight: bold;
            font-size: 1.1rem;
            color: #2c3e50;
        }
        
        .distance-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #3498db;
        }
        
        .distance-unit {
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        .simulation-controls {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            text-align: center;
        }
        
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            cursor: pointer;
            margin: 0 10px;
            font-size: 1rem;
            transition: background 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
        }
        
        button:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        
        footer {
            text-align: center;
            padding: 15px;
            color: #7f8c8d;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @media (max-width: 600px) {
            .container {
                border-radius: 10px;
                height: 95vh;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            button {
                display: block;
                width: 100%;
                margin: 10px 0;
            }
            
            .gallery-main-image {
                height: 250px;
            }
            
            .distance-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .distance-value {
                margin-top: 5px;
                align-self: flex-end;
            }
            
            .poi-title {
                font-size: 1.7rem;
            }
            
            .poi-description {
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>GPS Felfedező App</h1>
            <p>Fedezz fel érdekes helyeket a közeledben!</p>
        </header>
        
        <div class="content">
            <div class="poi-content">
                <div id="poi-info" class="poi-info">
                    <div class="image-gallery">
                        <img id="gallery-main-image" class="gallery-main-image" src="" alt="POI image">
                        <div class="gallery-nav">
                            <button class="gallery-btn" id="prev-btn"><i class="fas fa-chevron-left"></i></button>
                            <button class="gallery-btn" id="next-btn"><i class="fas fa-chevron-right"></i></button>
                        </div>
                        <div class="gallery-thumbnails" id="gallery-thumbnails"></div>
                    </div>
                    
                    <h2 id="poi-title" class="poi-title"></h2>
                    <p id="poi-description" class="poi-description"></p>
                    <div class="audio-controls">
                        <audio id="poi-audio" controls></audio>
                    </div>
                    <button id="close-poi">Bezárás</button>
                </div>
                
                <div class="simulation-controls">
                    <h2>Helyszín kipróbálása</h2>
                    <p>Válassz egy helyszínt a teszteléshez:</p>
                    <button id="simulate-buda">Budai Vár</button>
                    <button id="simulate-halaszbastya">Halászbástya</button>
                    <button id="simulate-lanchid">Lánchíd</button>
                </div>
            </div>
            
            <div class="distance-container">
                <div class="welcome-message">
                    <p>Az alkalmazás mutatja a közeledben lévő érdekes helyek távolságát.</p>
                    <p>Amikor egy hely közelébe érsz, itt megjelenik a tartalom.</p>
                </div>
                
                <div id="distance-info" class="distance-info">
                    <!-- A távolság információk ide fognak kerülni -->
                </div>
            </div>
        </div>
        
        <footer>
            <p>© 2023 GPS Felfedező App | Fedezd fel a világot!</p>
        </footer>
    </div>

    <script>
        // Koordináta konverzió függvény
        function dmsToDecimal(degrees, minutes, seconds, direction) {
            let decimal = degrees + minutes / 60 + seconds / 3600;
            if (direction === 'S' || direction === 'W') {
                decimal = -decimal;
            }
            return decimal;
        }
        
        // Budai Vár koordinátái: 46°14'43.82"É, 20° 9'27.32"K
        const budaiVarLat = dmsToDecimal(46, 14, 43.82, 'N');
        const budaiVarLng = dmsToDecimal(20, 9, 27.32, 'E');
        
        // Halászbástya koordinátái: 46°15'32.36"É, 20° 9'59.65"K
        const halaszbastyaLat = dmsToDecimal(46, 15, 32.36, 'N');
        const halaszbastyaLng = dmsToDecimal(20, 9, 59.65, 'E');

        // Előre meghatározott érdekes pontok (POI-k) több képpel
        const pointsOfInterest = [
            {
                id: 1,
                name: "Budai Vár",
                lat: budaiVarLat,
                lng: budaiVarLng,
                radius: 100,
                images: [
                    "https://www.hetedhetorszag.hu/parameters/hetedhetorszag/modules/Attractions/documents/attraction/32816/image/9834/large.jpg",
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/3/3d/Budavari_palota_2016.jpg/800px-Budavari_palota_2016.jpg",
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/6/6f/Budapest_-_Buda_Castle2.jpg/800px-Budapest_-_Buda_Castle2.jpg"
                ],
                description: "A Budai Várnegyed a Duna jobb partján, a Várhegy tetején terül el. Több mint 700 éves múltra tekint vissza, és Budapest egyik leglátogatottabb nevezetessége. A történelmi palota és a középkori utcák egyedülálló atmoszférát teremtenek.",
                audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3"
            },
            {
                id: 2,
                name: "Halászbástya",
                lat: halaszbastyaLat,
                lng: halaszbastyaLng,
                radius: 50,
                images: [
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Hal%C3%A1szb%C3%A1stya_2017.jpg/800px-Hal%C3%A1szb%C3%A1stya_2017.jpg",
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Hal%C3%A1szb%C3%A1stya_a_Szenth%C3%A1roms%C3%A1g_szobr%C3%A1val.jpg/800px-Hal%C3%A1szb%C3%A1stya_a_Szenth%C3%A1roms%C3%A1g_szobr%C3%A1val.jpg",
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/9/9a/Hal%C3%A1szb%C3%A1stya_%282%29.jpg/800px-Hal%C3%A1szb%C3%A1stya_%282%29.jpg"
                ],
                description: "A Halászbástya Budapest egyik legismertebb látványossága, a Várnegyedben található. 1905-ben épült, neoromán stílusban. Kilátótornyaiból lenyűgöző panoráma nyílik a városra és a Dunara.",
                audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3"
            },
            {
                id: 3,
                name: "Széchenyi Lánchíd",
                lat: 47.4986,
                lng: 19.0439,
                radius: 80,
                images: [
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Sz%C3%A9chenyi_Chain_Bridge_%28Budapest%29.jpg/800px-Sz%C3%A9chenyi_Chain_Bridge_%28Budapest%29.jpg",
                    "https://upload.wikimedia.org/wikipedia/commons/thumb/0/00/2015_Budapest_-_Sz%C3%A9chenyi_L%C3%A1nch%C3%ADd_2.jpg/800px-2015_Budapest_-_Sz%C3%A9chenyi_L%C3%A1nch%C3%ADd_2.jpg",
                    "https://upload.wikimedia.org.wikimedia.org/wikipedia/commons/thumb/4/4a/Budapest_Chain_Bridge_at_night.jpg/800px-Budapest_Chain_Bridge_at_night.jpg"
                ],
                description: "A Széchenyi lánchíd Budapest legrégebbi és legismertebb hidja, amely Budát és Pestet köti össze. 1849-ben adták át a forgalomnak. Az úttörő mérnöki alkotás ma is a város egyik szimbóluma.",
                audio: "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3"
            }
        ];

        // Alkalmazás állapota
        let currentPosition = null;
        let watchId = null;
        let currentPoi = null;
        let currentImageIndex = 0;

        // Elemek kiválasztása
        const distanceInfo = document.getElementById('distance-info');
        const poiInfo = document.getElementById('poi-info');
        const galleryMainImage = document.getElementById('gallery-main-image');
        const galleryThumbnails = document.getElementById('gallery-thumbnails');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const poiTitle = document.getElementById('poi-title');
        const poiDescription = document.getElementById('poi-description');
        const poiAudio = document.getElementById('poi-audio');
        const closePoiButton = document.getElementById('close-poi');

        // Szimulációs gombok
        const simulateBuda = document.getElementById('simulate-buda');
        const simulateHalaszbastya = document.getElementById('simulate-halaszbastya');
        const simulateLanchid = document.getElementById('simulate-lanchid');

        // Távolság információk frissítése
        function updateDistanceInfo() {
            if (!currentPosition) return;
            
            const { latitude, longitude } = currentPosition.coords;
            
            // Távolság információk létrehozása/frissítése
            distanceInfo.innerHTML = '';
            
            pointsOfInterest.forEach(poi => {
                const distance = calculateDistance(
                    latitude, longitude, 
                    poi.lat, poi.lng
                );
                
                const distanceElement = document.createElement('div');
                distanceElement.className = 'distance-item';
                
                // Ha a felhasználó a hatósugáron belül van
                if (distance <= poi.radius) {
                    distanceElement.classList.add('reached');
                }
                
                distanceElement.innerHTML = `
                    <span class="poi-name">${poi.name}</span>
                    <span class="distance-value">${Math.round(distance)} <span class="distance-unit">m</span></span>
                `;
                
                distanceInfo.appendChild(distanceElement);
            });
        }

        // Képgaléria inicializálása
        function initGallery(poi) {
            galleryThumbnails.innerHTML = '';
            currentImageIndex = 0;
            
            if (poi.images && poi.images.length > 0) {
                galleryMainImage.src = poi.images[0];
                
                // Bélyegképek létrehozása
                poi.images.forEach((image, index) => {
                    const thumb = document.createElement('img');
                    thumb.src = image;
                    thumb.alt = `Thumbnail ${index + 1}`;
                    thumb.className = 'gallery-thumbnail';
                    if (index === 0) thumb.classList.add('active');
                    
                    thumb.addEventListener('click', () => {
                        currentImageIndex = index;
                        updateGallery(poi);
                    });
                    
                    galleryThumbnails.appendChild(thumb);
                });
                
                // Navigációs gombok eseménykezelői
                prevBtn.onclick = () => {
                    currentImageIndex = (currentImageIndex - 1 + poi.images.length) % poi.images.length;
                    updateGallery(poi);
                };
                
                nextBtn.onclick = () => {
                    currentImageIndex = (currentImageIndex + 1) % poi.images.length;
                    updateGallery(poi);
                };
            }
        }
        
        // Galéria frissítése
        function updateGallery(poi) {
            galleryMainImage.src = poi.images[currentImageIndex];
            
            // Aktív bélyegkép frissítése
            const thumbs = galleryThumbnails.querySelectorAll('.gallery-thumbnail');
            thumbs.forEach((thumb, index) => {
                if (index === currentImageIndex) {
                    thumb.classList.add('active');
                } else {
                    thumb.classList.remove('active');
                }
            });
        }

        // Helymeghatározás inicializálása
        function initGeolocation() {
            if (!navigator.geolocation) {
                distanceInfo.innerHTML = '<p>A böngésző nem támogatja a helymeghatározást</p>';
                return;
            }
            
            // Pozíció változás figyelése
            watchId = navigator.geolocation.watchPosition(
                position => {
                    currentPosition = position;
                    checkForNearbyPois();
                    updateDistanceInfo();
                },
                error => {
                    distanceInfo.innerHTML = '<p>Helymeghatározás nem elérhető</p>';
                },
                {
                    enableHighAccuracy: true,
                    timeout: 10000,
                    maximumAge: 60000
                }
            );
        }

        // Közeledben lévő POI-k ellenőrzése
        function checkForNearbyPois() {
            if (!currentPosition) return;
            
            const { latitude, longitude } = currentPosition.coords;
            
            pointsOfInterest.forEach(poi => {
                const distance = calculateDistance(
                    latitude, longitude, 
                    poi.lat, poi.lng
                );
                
                // Ha a felhasználó elég közel van egy POI-hoz
                if (distance <= poi.radius && currentPoi !== poi.id) {
                    currentPoi = poi.id;
                    showPoiInfo(poi);
                }
            });
        }

        // Két koordináta közötti távolság számítása (Haversine formula)
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371000; // Föld sugara méterben
            const dLat = deg2rad(lat2 - lat1);
            const dLon = deg2rad(lon2 - lon1);
            const a = 
                Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * 
                Math.sin(dLon/2) * Math.sin(dLon/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            const distance = R * c;
            return distance;
        }

        function deg2rad(deg) {
            return deg * (Math.PI/180);
        }

        // POI információk megjelenítése
        function showPoiInfo(poi) {
            poiTitle.textContent = poi.name;
            poiDescription.textContent = poi.description;
            poiAudio.src = poi.audio;
            
            initGallery(poi);
            poiInfo.classList.add('active');
            
            // Hang automatikus lejátszása
            setTimeout(() => {
                poiAudio.play().catch(e => {
                    console.log("Automatikus hanglejátszás nem engedélyezett");
                });
            }, 500);
        }

        // Szimulációs funkciók
        simulateBuda.addEventListener('click', () => {
            simulatePosition(budaiVarLat, budaiVarLng, "Budai Vár");
        });

        simulateHalaszbastya.addEventListener('click', () => {
            simulatePosition(halaszbastyaLat, halaszbastyaLng, "Halászbástya");
        });

        simulateLanchid.addEventListener('click', () => {
            simulatePosition(47.4986, 19.0439, "Széchenyi Lánchíd");
        });

        function simulatePosition(lat, lng, name) {
            // Szimuláljunk egy pozíciót
            currentPosition = {
                coords: {
                    latitude: lat,
                    longitude: lng,
                    accuracy: 10
                }
            };
            
            checkForNearbyPois();
            updateDistanceInfo();
        }

        // Bezárás gomb eseménykezelő
        closePoiButton.addEventListener('click', () => {
            poiInfo.classList.remove('active');
            poiAudio.pause();
        });

        // Alkalmazás inicializálása
        function initApp() {
            initGeolocation();
        }

        // Alkalmazás indítása
        initApp();
    </script>
</body>
</html>
